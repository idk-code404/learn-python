<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Learn Python ‚Äî Home</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="page-header">
    <div class="header-inner">
      <div class="brand">
        <h1>üêç Learn Python</h1>
        <p class="lead">Interactive lessons, quizzes, and a live playground</p>
      </div>

      <nav class="mini-nav" aria-label="Main navigation">
        <a href="lessons.html" class="mini-nav-link">Lessons</a>
        <a href="questions.html" class="mini-nav-link">Quizzes</a>
        <a href="dashboard.html" class="mini-nav-link">Dashboard</a>
        <a href="playground.html" class="mini-nav-link">Playground</a>
      </nav>
    </div>
  </header>

  <main class="container center" style="padding:28px 16px;">
    <section style="max-width:980px;margin:0 auto;text-align:center;">
      <h2>Welcome ‚Äî learn Python step-by-step</h2>
      <p class="small">Start with beginner lessons, practice with quizzes, and try code in the embedded playground.</p>

      <div style="display:flex;gap:12px;justify-content:center;margin-top:18px;flex-wrap:wrap;">
        <a class="btn" href="lessons.html">Browse Lessons</a>
        <a class="btn" href="questions.html">Take a Quiz</a>
        <a class="btn" href="playground.html">Open Playground</a>
      </div>

      <div id="home-stats" style="margin-top:26px;display:flex;gap:12px;justify-content:center;flex-wrap:wrap;">
        <!-- Stats are filled by script -->
      </div>
    </section>
  </main>

  <script>
    // Show a quick snapshot of progress and quiz stats on the homepage
    (async function () {
      // Load lessons to determine total
      try {
        const r = await fetch('lessons.json');
        const lessons = await r.json();
        const totalLessons = lessons.length;

        const progress = JSON.parse(localStorage.getItem('progress')) || {};
        const completed = Object.values(progress).filter(v => v === true).length;

        const quizStats = JSON.parse(localStorage.getItem('quizStats')) || {};
        // compute total attempts across categories
        let totalAttempts = 0, avgAcross = 0, categories = 0;
        for (const k in quizStats) {
          totalAttempts += (quizStats[k].attempts || 0);
          if ((quizStats[k].scores || []).length) {
            const s = quizStats[k].scores.reduce((a,b) => a+b,0) / quizStats[k].scores.length;
            avgAcross += s; categories++;
          }
        }
        const avgScore = categories ? Math.round(avgAcross / categories) : 0;

        const homeStats = document.getElementById('home-stats');
        homeStats.innerHTML = `
          <div class="lesson-card" style="min-width:160px">
            <h4 style="margin:6px 0">Lessons</h4>
            <p class="small">${completed} / ${totalLessons} completed</p>
          </div>
          <div class="lesson-card" style="min-width:160px">
            <h4 style="margin:6px 0">Quiz Attempts</h4>
            <p class="small">${totalAttempts} attempts</p>
          </div>
          <div class="lesson-card" style="min-width:160px">
            <h4 style="margin:6px 0">Avg Quiz Score</h4>
            <p class="small">${avgScore}%</p>
          </div>
        `;
      } catch (e) {
        console.error('Failed to load lessons for homepage stats', e);
      }
    })();
  </script>
</body>
</html>
